| Pin | Symbol | Alias | Note |
| :---: | :---: | :---: | --- |
| 1 | <span style="color:red">**DI/DAT**</span> | | 信号流向：手柄 => 主机、此信号是一个8Bit串行数据、同步传送于CLK的下降沿。信号的读取在CLK由高变低的变化过程中完成 |
| 2 | **DO/CMD** | | 信号流向：主机 => 手柄、此信号与DI对应、是一个8Bit串行数据、同步传送于CLK的下降沿 |
| 3 | NC | |  |
| 4 | GND | |  |
| 5 | VDD | | 接收器工作电源：3~5V |
| 6 | **CS/SEL** | ATT | 用于提供手柄触发信号、在通讯期间、处于低电平 |
| 7 | **CLK** || 时钟信号、由主机发出、用于保持数据同步 |
| 8 | NC |  | |
| 9 | ~~ACK~~ | | 手柄 => 主机的应答信号、此信号在每个8bits数据发送的最后一个周期变低并且CS一直保持低电平、如果CS信号不变低、约60微秒PS主机会尝试另外一个外设、在编程时未使用ACK端口 |

```
MISO (Master In Slave Out) - The Slave line for sending data to the master,
MOSI (Master Out Slave In) - The Master line for sending data to the peripherals,
SCK (Serial Clock) - The clock pulses which synchronize data transmission generated by the master
```
```
CLK : 500kH/z, normally high on. The communication appears to be SPI bus. We’ve gotten it to work from less than 100kHz up through 500kHz (500k bits / second, not counting delays between bytes and packets). When the guitar hero controller is connected, the clock rate is 250kHz, which is also the rate the playstation 1 uses.
```

* [Interfacing a PS2 (PlayStation 2) Controller](http://store.curiousinventor.com/guides/PS2/)
* [Playstation 2 Logic Analysis](http://blog.nearfuturelaboratory.com/2008/06/19/playstation2-logic-analysis/)
* [Interfacing PS2 Controller With AVR -Bit Bang](https://www.instructables.com/id/Interfacing-PS2-controller-with-AVR-Bit-Bang/)
* [Interfacing PS2 Wireless Controller With Arduino](https://www.rhydolabz.com/wiki/?p=12663)
* http://www.wegmuller.org/arduino/Arduino-Playstation_gameport.html
* [**Playstation 2 Dual Shock protocol, revisited**](https://scanlime.org/2008/07/playstation-2-dual-shock-protocol-revisited/)

## Arduino SPI

| Pin | Symbol | Alias | Note |
| :---: | :---: | :---: | --- |
| 10 | SS | | CS/SEL |
| 11 | MOSI | | CMD |
| 12 | MISO | | DAT |
| 13 | CLK | | CLK |

## OneBot BB Pin Map
```
1 => CS/SEL/ATT
2 => CLK
3 => DAT/MISO
4 => CMD/MOSI
```

## STM32 Cube MX Configuration

| Mode                  | Full-Duplex Master       |
| --------------------- | ------------------------ |
| Hardware NSS Signal   | Disable                  |
| Frame Format          | Motorola                 |
| Data Size             | 8 Bits                   |
| First Bit             | LSB First                |
| Prescaler             | 128 (256???)                |
| Baud Rate             | 375.0 KBits/s (自动生成) |
| Clock Polarity (CPOL) | High                     |
| Clock Phase (CPHA)    | 2 Edge                   |
| CRC Calculation       | Disabled                 |
| NSS Signal Type       | Software                 |

## 手柄转接板电路分析

只有到了LDC3G/A19T，以及若干个电阻、看来不用它也行、直接连接收器可以节约空间

## PSX协议总结
与SPI协议极度相似、差别在于
 * SPI可以连续传输（以Byte为单位）、PSX一次只传输一个Byte、直到收到ACK再传输下一个Byte
